<?xml version="1.0"?><DTS:Executable xmlns:DTS="www.microsoft.com/SqlServer/Dts" DTS:ExecutableType="SSIS.Package.2">
<DTS:Property DTS:Name="PackageFormatVersion">3</DTS:Property>
<DTS:Property DTS:Name="VersionComments"></DTS:Property>
<DTS:Property DTS:Name="CreatorName">WALLC\116773</DTS:Property>
<DTS:Property DTS:Name="CreatorComputerName">WAHQ-ECOM-EE3A</DTS:Property>
<DTS:Property DTS:Name="CreationDate" DTS:DataType="7">1/4/2013 5:41:50 PM</DTS:Property>
<DTS:Property DTS:Name="PackageType">5</DTS:Property>
<DTS:Property DTS:Name="ProtectionLevel">1</DTS:Property>
<DTS:Property DTS:Name="MaxConcurrentExecutables">-1</DTS:Property>
<DTS:Property DTS:Name="PackagePriorityClass">0</DTS:Property>
<DTS:Property DTS:Name="VersionMajor">1</DTS:Property>
<DTS:Property DTS:Name="VersionMinor">0</DTS:Property>
<DTS:Property DTS:Name="VersionBuild">46</DTS:Property>
<DTS:Property DTS:Name="VersionGUID">{6A8F910B-7EA3-49FF-BCBF-606A7712EA7B}</DTS:Property>
<DTS:Property DTS:Name="EnableConfig">0</DTS:Property>
<DTS:Property DTS:Name="CheckpointFileName"></DTS:Property>
<DTS:Property DTS:Name="SaveCheckpoints">0</DTS:Property>
<DTS:Property DTS:Name="CheckpointUsage">0</DTS:Property>
<DTS:Property DTS:Name="SuppressConfigurationWarnings">0</DTS:Property>
<DTS:ConnectionManager>
<DTS:Property DTS:Name="DelayValidation">0</DTS:Property>
<DTS:Property DTS:Name="ObjectName">10.7.0.21,1500.CATALOG.WIRELESSADVOCATES.COM1</DTS:Property>
<DTS:Property DTS:Name="DTSID">{35EBFA4D-56E0-4AE7-B150-926D35AFBDE7}</DTS:Property>
<DTS:Property DTS:Name="Description"></DTS:Property>
<DTS:Property DTS:Name="CreationName">ADO.NET:System.Data.SqlClient.SqlConnection, System.Data, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</DTS:Property><DTS:ObjectData><DTS:ConnectionManager>
<DTS:Property DTS:Name="Retain">0</DTS:Property>
<DTS:Property DTS:Name="ConnectionString">Data Source=10.7.0.221;Initial Catalog=CATALOG.COMPARE;Integrated Security=True;Application Name=SSIS-Package-{35EBFA4D-56E0-4AE7-B150-926D35AFBDE7}10.7.0.21,1500.TEST.WIRELESSADVOCATES.COM1;</DTS:Property></DTS:ConnectionManager></DTS:ObjectData></DTS:ConnectionManager>
<DTS:ConnectionManager>
<DTS:Property DTS:Name="DelayValidation">0</DTS:Property>
<DTS:Property DTS:Name="ObjectName">AT&amp;T Catalog Load.xlsx</DTS:Property>
<DTS:Property DTS:Name="DTSID">{CF314A2E-A075-4462-9666-3A1C8E1F6CB9}</DTS:Property>
<DTS:Property DTS:Name="Description"></DTS:Property>
<DTS:Property DTS:Name="CreationName">FILE</DTS:Property><DTS:ObjectData><DTS:ConnectionManager>
<DTS:Property DTS:Name="FileUsageType">0</DTS:Property>
<DTS:Property DTS:Name="ConnectionString">C:\Test\CatalogLoad.xlsx</DTS:Property></DTS:ConnectionManager></DTS:ObjectData></DTS:ConnectionManager>
<DTS:ConnectionManager>
<DTS:Property DTS:Name="DelayValidation">0</DTS:Property>
<DTS:Property DTS:Name="ObjectName">AT&amp;T Catalog Load.xlsx 1</DTS:Property>
<DTS:Property DTS:Name="DTSID">{259A518E-FB44-4FE2-9ED7-A670B0C56D9A}</DTS:Property>
<DTS:Property DTS:Name="Description"></DTS:Property>
<DTS:Property DTS:Name="CreationName">FILE</DTS:Property><DTS:ObjectData><DTS:ConnectionManager>
<DTS:Property DTS:Name="FileUsageType">1</DTS:Property>
<DTS:Property DTS:Name="ConnectionString">C:\Test\CatalogLoad.xlsx</DTS:Property></DTS:ConnectionManager></DTS:ObjectData></DTS:ConnectionManager>
<DTS:ConnectionManager>
<DTS:Property DTS:Name="DelayValidation">0</DTS:Property>
<DTS:Property DTS:Name="ObjectName">Excel Connection Manager</DTS:Property>
<DTS:Property DTS:Name="DTSID">{4E8E0C3B-2471-4792-BF2C-4B9D2435F58C}</DTS:Property>
<DTS:Property DTS:Name="Description"></DTS:Property>
<DTS:Property DTS:Name="CreationName">EXCEL</DTS:Property><DTS:ObjectData><DTS:ConnectionManager>
<DTS:Property DTS:Name="Retain">0</DTS:Property>
<DTS:Property DTS:Name="ConnectionString">Provider=Microsoft.ACE.OLEDB.12.0;Data Source=C:\Test\CatalogLoad.xlsx;Extended Properties="EXCEL 12.0 XML;HDR=YES";</DTS:Property></DTS:ConnectionManager></DTS:ObjectData></DTS:ConnectionManager>
<DTS:ConnectionManager>
<DTS:Property DTS:Name="DelayValidation">0</DTS:Property>
<DTS:Property DTS:Name="ObjectName">Template.xlsx</DTS:Property>
<DTS:Property DTS:Name="DTSID">{591D1B59-1323-4E1A-B21C-AF3CDCDDE412}</DTS:Property>
<DTS:Property DTS:Name="Description"></DTS:Property>
<DTS:Property DTS:Name="CreationName">FILE</DTS:Property><DTS:ObjectData><DTS:ConnectionManager>
<DTS:Property DTS:Name="FileUsageType">0</DTS:Property>
<DTS:Property DTS:Name="ConnectionString">C:\Test\Template.xlsx</DTS:Property></DTS:ConnectionManager></DTS:ObjectData></DTS:ConnectionManager>
<DTS:Property DTS:Name="LastModifiedProductVersion">10.50.4000.0</DTS:Property>
<DTS:Property DTS:Name="ForceExecValue">0</DTS:Property>
<DTS:Property DTS:Name="ExecValue" DTS:DataType="3">0</DTS:Property>
<DTS:Property DTS:Name="ForceExecutionResult">-1</DTS:Property>
<DTS:Property DTS:Name="Disabled">0</DTS:Property>
<DTS:Property DTS:Name="FailPackageOnFailure">0</DTS:Property>
<DTS:Property DTS:Name="FailParentOnFailure">0</DTS:Property>
<DTS:Property DTS:Name="MaxErrorCount">1</DTS:Property>
<DTS:Property DTS:Name="ISOLevel">1048576</DTS:Property>
<DTS:Property DTS:Name="LocaleID">1033</DTS:Property>
<DTS:Property DTS:Name="TransactionOption">1</DTS:Property>
<DTS:Property DTS:Name="DelayValidation">0</DTS:Property>
<DTS:LoggingOptions>
<DTS:Property DTS:Name="LoggingMode">0</DTS:Property>
<DTS:Property DTS:Name="FilterKind">1</DTS:Property>
<DTS:Property DTS:Name="EventFilter" DTS:DataType="8"></DTS:Property></DTS:LoggingOptions>
<DTS:Executable DTS:ExecutableType="Microsoft.SqlServer.Dts.Tasks.ExecuteSQLTask.ExecuteSQLTask, Microsoft.SqlServer.SQLTask, Version=10.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91" DTS:ThreadHint="0">
<DTS:Property DTS:Name="ExecutionLocation">0</DTS:Property>
<DTS:Property DTS:Name="ExecutionAddress"></DTS:Property>
<DTS:Property DTS:Name="TaskContact">Execute SQL Task; Microsoft Corporation; Microsoft SQL Server 2008 R2; Â© 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1</DTS:Property>
<DTS:Property DTS:Name="ForceExecValue">0</DTS:Property>
<DTS:Property DTS:Name="ExecValue" DTS:DataType="3">0</DTS:Property>
<DTS:Property DTS:Name="ForceExecutionResult">-1</DTS:Property>
<DTS:Property DTS:Name="Disabled">0</DTS:Property>
<DTS:Property DTS:Name="FailPackageOnFailure">0</DTS:Property>
<DTS:Property DTS:Name="FailParentOnFailure">0</DTS:Property>
<DTS:Property DTS:Name="MaxErrorCount">1</DTS:Property>
<DTS:Property DTS:Name="ISOLevel">1048576</DTS:Property>
<DTS:Property DTS:Name="LocaleID">-1</DTS:Property>
<DTS:Property DTS:Name="TransactionOption">1</DTS:Property>
<DTS:Property DTS:Name="DelayValidation">0</DTS:Property>
<DTS:LoggingOptions>
<DTS:Property DTS:Name="LoggingMode">0</DTS:Property>
<DTS:Property DTS:Name="FilterKind">1</DTS:Property>
<DTS:Property DTS:Name="EventFilter" DTS:DataType="8"></DTS:Property></DTS:LoggingOptions>
<DTS:Property DTS:Name="ObjectName">Execute SQL Task</DTS:Property>
<DTS:Property DTS:Name="DTSID">{F8517981-8F6B-40F2-9EDD-2DC1057F3BBD}</DTS:Property>
<DTS:Property DTS:Name="Description">Execute SQL Task</DTS:Property>
<DTS:Property DTS:Name="CreationName">Microsoft.SqlServer.Dts.Tasks.ExecuteSQLTask.ExecuteSQLTask, Microsoft.SqlServer.SQLTask, Version=10.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91</DTS:Property>
<DTS:Property DTS:Name="DisableEventHandlers">0</DTS:Property><DTS:ObjectData><SQLTask:SqlTaskData SQLTask:Connection="{35EBFA4D-56E0-4AE7-B150-926D35AFBDE7}" SQLTask:TimeOut="6000" SQLTask:IsStoredProc="False" SQLTask:BypassPrepare="True" SQLTask:SqlStmtSourceType="DirectInput" SQLTask:SqlStatementSource="--Carrier Information for Report&#xA;DECLARE @Carrier nvarchar(50)&#xA;SELECT @Carrier = CarrierName FROM catalogthisweek.Device&#xA;&#xA;&#xA;DECLARE @table AS TABLE(Emp_Email NVARCHAR(100), ID int IDENTITY(1,1))&#xA;&#xA;--populate the above table&#xA;INSERT @table (Emp_Email) VALUES('nhall@wirelessadvocates.com')&#xA;INSERT @table (Emp_Email) VALUES('csmith@wirelessadvocates.com')&#xA;INSERT @table (Emp_Email) VALUES('csager@wirelessadvocates.com')&#xA;&#xA;DECLARE @count AS int&#xA;SET @count =1 --initialize the count parameter&#xA;DECLARE @Recepient_Email AS VARCHAR(100)&#xA;WHILE (@count &lt;=(SELECT COUNT(*) FROM @table))&#xA;        BEGIN&#xA;        SET @Recepient_Email =(SELECT TOP(1) Emp_Email FROM @table WHERE ID=@count)&#xA;&#xA;DECLARE @subjtext AS NVARCHAR(255)&#xA;SET @subjtext = @Carrier + ': Pre-Load Catalog Comparison Report'&#xA;&#xA;EXECUTE msdb.dbo.sp_send_dbmail&#xA;    @recipients = @Recepient_Email,&#xA;    @subject = @subjtext,&#xA;    @profile_name = 'Default',&#xA;    @body_format = 'html',&#xA;    @exclude_query_output = 1,&#xA;    @append_query_error = 1,&#xA;    @query = '&#xA;    PRINT ''&lt;html&gt;''&#xA;	USE [CATALOG.COMPARE]&#xA;&#xA;    DECLARE @Carrier nvarchar(50)&#xA;	SELECT @Carrier = CarrierName FROM catalogthisweek.Device&#xA;&#xA;	PRINT ''&lt;br&gt;&lt;br&gt;''&#xA;	PRINT ''&lt;span style=&quot;font-family:Calibri,Verdana,serif&quot;&gt;''&#xA;	PRINT ''&lt;h2&gt;Pre-Load Catalog Comparison Report for '' + @Carrier + ''&lt;br&gt;Executed on '' + CONVERT(varchar(100), GETDATE()) + ''&lt;/h2&gt;''&#xA;    IF (SELECT Push FROM report.summary WHERE Section = ''Summary Line'') = ''Y''&#xA;	BEGIN&#xA;		PRINT ''&lt;h1&gt;Recommend to Push: &lt;b&gt;YES&lt;/b&gt;&lt;/h1&gt;''&#xA;	END&#xA;	ELSE&#xA;		PRINT ''&lt;h1&gt;Recommend to Push: &lt;b&gt;NO&lt;/b&gt;&lt;/h1&gt;''&#xA;&#xA;&#xA;&#xA;			IF (SELECT Push FROM report.summary WHERE Section = ''04. Product Details'') = ''Y'' AND (SELECT DISTINCT MAX(Push) from report.summary WHERE Section NOT IN (''04. Product Details'',''Summary Line'')) = ''N''&#xA;			BEGIN&#xA;			PRINT ''&lt;span style=&quot;color:red;&quot;&gt;&lt;b&gt;PLEASE NOTE:&lt;/b&gt; Only product details and properties were detected. Please review to see if changes truly require a data push.&lt;/span&gt;''&#xA;			END&#xA;&#xA;    PRINT ''&lt;br&gt;&lt;br&gt;''&#xA;&#xA;    PRINT ''&lt;span style=&quot;font-size:small;&quot;&gt;Please find reporting details for review below.&lt;/span&gt;''	&#xA;&#xA;    PRINT ''&lt;br&gt;&lt;br&gt;''&#xA;&#xA;PRINT ''&lt;h3&gt;Summary of Carrier Catalog Files&lt;/h3&gt;''&#xA;EXECUTE SaveSummaryTableAsHTML @DBFetch = ''SELECT * FROM report.summary''&#xA;&#xA;&#xA;IF EXISTS (SELECT 1 FROM report.new_devices)&#xA;		BEGIN&#xA;			PRINT ''&lt;h4&gt;01. New Devices&lt;/h4&gt;''&#xA;			EXECUTE SaveTableAsHTML @DBFetch = ''SELECT UPC, Name, Manufacturer FROM report.new_devices''&#xA;		END&#xA;&#xA;IF EXISTS (SELECT 1 FROM report.old_devices)&#xA;		BEGIN&#xA;			PRINT ''&lt;h4&gt;01. Removed Devices&lt;/h4&gt;''&#xA;			EXECUTE SaveTableAsHTML @DBFetch = ''SELECT UPC, Name, Manufacturer FROM report.old_devices''&#xA;		END&#xA;&#xA;IF EXISTS (SELECT 1 FROM report.updated_devices)&#xA;		BEGIN&#xA;			PRINT ''&lt;h4&gt;01. Updated Devices&lt;/h4&gt;''&#xA;			EXECUTE SaveTableAsHTML @DBFetch = ''SELECT Updated, UPC, Name, Manufacturer FROM report.updated_devices''&#xA;		END&#xA;&#xA;IF EXISTS (SELECT 1 FROM report.new_rateplans)&#xA;		BEGIN&#xA;			PRINT ''&lt;h4&gt;02. New Rateplans&lt;/h4&gt;''&#xA;			EXECUTE SaveTableAsHTML @DBFetch = ''SELECT CarrierBillCode, Title, MonthlyFee, MaxLines, ContractTerm, IncludedLines, Type FROM report.new_rateplans''&#xA;		END&#xA;&#xA;IF EXISTS (SELECT 1 FROM report.old_rateplans)&#xA;		BEGIN&#xA;			PRINT ''&lt;h4&gt;02. Removed Rateplans&lt;/h4&gt;''&#xA;			EXECUTE SaveTableAsHTML @DBFetch = ''SELECT CarrierBillCode, Title, MonthlyFee, MaxLines, ContractTerm, IncludedLines, Type FROM report.old_rateplans''&#xA;		END&#xA;&#xA;IF EXISTS (SELECT 1 FROM report.updated_rateplans)&#xA;		BEGIN&#xA;			PRINT ''&lt;h4&gt;02. Updated Rateplans&lt;/h4&gt;''&#xA;			EXECUTE SaveTableAsHTML @DBFetch = ''SELECT Updated, CarrierBillCode, Title, MonthlyFee, MaxLines, ContractTerm, IncludedLines, Type FROM report.updated_rateplans''&#xA;		END&#xA;		&#xA;IF EXISTS (SELECT 1 FROM report.new_services)&#xA;		BEGIN&#xA;			PRINT ''&lt;h4&gt;03. New Services&lt;/h4&gt;''&#xA;			EXECUTE SaveTableAsHTML @DBFetch = ''SELECT CarrierBillCode, Title, MonthlyFee FROM report.new_services''&#xA;		END&#xA;&#xA;IF EXISTS (SELECT 1 FROM report.old_services)&#xA;		BEGIN&#xA;			PRINT ''&lt;h4&gt;03. Removed Services&lt;/h4&gt;''&#xA;			EXECUTE SaveTableAsHTML @DBFetch = ''SELECT CarrierBillCode, Title, MonthlyFee FROM report.old_services''&#xA;		END&#xA;&#xA;IF EXISTS (SELECT 1 FROM report.updated_services)&#xA;		BEGIN&#xA;			PRINT ''&lt;h4&gt;03. Updated Services&lt;/h4&gt;''&#xA;			EXECUTE SaveTableAsHTML @DBFetch = ''SELECT Updated, CarrierBillCode, Title, MonthlyFee FROM report.updated_services''&#xA;		END&#xA;&#xA;IF EXISTS (SELECT 1 FROM report.new_property)&#xA;		BEGIN&#xA;			PRINT ''&lt;h4&gt;04. New Product Details&lt;/h4&gt;''&#xA;			EXECUTE SaveTableAsHTML @DBFetch = ''SELECT * FROM report.new_property''&#xA;		END&#xA;&#xA;/* &#xA;IF EXISTS (SELECT 1 FROM report.old_property)&#xA;		BEGIN&#xA;			PRINT ''&lt;h4&gt;04. Removed Product Details&lt;/h4&gt;''&#xA;			EXECUTE SaveTableAsHTML @DBFetch = ''SELECT * FROM report.old_property''&#xA;		END&#xA; */&#xA;&#xA;IF EXISTS (SELECT 1 FROM report.updated_property)&#xA;		BEGIN&#xA;			PRINT ''&lt;h4&gt;04. Updated Product Details&lt;/h4&gt;''&#xA;			EXECUTE SaveTableAsHTML @DBFetch = ''SELECT * FROM report.updated_property''&#xA;		END&#xA;&#xA;&#xA;IF (SELECT MAX(1) FROM report.new_devices) &gt; 0 OR (SELECT MAX(1) FROM report.new_services) &gt; 0&#xA;		BEGIN&#xA;			PRINT ''&lt;h4&gt;05. New Associations for Device to Service&lt;/h4&gt;''&#xA;			EXECUTE SaveTableAsHTML @DBFetch = ''SELECT DISTINCT pg.UPC, nd.Name, STUFF((SELECT ^, ^ + cptg.carrierserviceid FROM (SELECT * FROM catalogthisweek.DeviceService cdst WHERE NOT EXISTS (SELECT * FROM cataloglastweek.DeviceService cdsl WHERE cdst.UPC = cdsl.UPC AND cdst.CarrierServiceId = cdsl.CarrierServiceId)) cptg WHERE cptg.upc = pg.upc FOR XML PATH (^^)), 1, 1, ^^) ServiceBillCodes FROM (SELECT * FROM catalogthisweek.DeviceService cdst WHERE NOT EXISTS (SELECT * FROM cataloglastweek.DeviceService cdsl WHERE cdst.UPC = cdsl.UPC AND cdst.CarrierServiceId = cdsl.CarrierServiceId)) pg LEFT OUTER JOIN catalogthisweek.device nd ON nd.upc = pg.upc''&#xA;		END&#xA;&#xA;/* &#xA;IF EXISTS (SELECT 1 FROM report.old_deviceservice)&#xA;		BEGIN&#xA;			PRINT ''&lt;h4&gt;05. Removed Associations for Device to Services&lt;/h4&gt;''&#xA;			EXECUTE SaveTableAsHTML @DBFetch = ''SELECT DISTINCT pg.UPC, nd.Name DeviceName, STUFF((SELECT ^, ^ + cptg.carrierserviceid FROM (SELECT * FROM cataloglastweek.DeviceService cdsl WHERE NOT EXISTS (SELECT * FROM catalogthisweek.DeviceService cdst WHERE cdsl.UPC = cdst.UPC AND cdsl.CarrierServiceId = cdst.CarrierServiceId)) cptg WHERE cptg.upc = pg.upc FOR XML PATH (^^)), 1, 1, ^^) ServiceBillCodes FROM (SELECT * FROM cataloglastweek.DeviceService cdsl WHERE NOT EXISTS (SELECT * FROM catalogthisweek.DeviceService cdst WHERE cdsl.UPC = cdst.UPC AND cdsl.CarrierServiceId = cdst.CarrierServiceId)) pg LEFT OUTER JOIN cataloglastweek.device nd ON nd.upc = pg.upc''&#xA;		END&#xA;*/&#xA;&#xA;IF (SELECT MAX(1) FROM report.new_devices) &gt; 0 OR (SELECT MAX(1) FROM report.new_rateplans) &gt; 0&#xA;		BEGIN&#xA;			PRINT ''&lt;h4&gt;06. New Associations for Rateplan to Device&lt;/h4&gt;''&#xA;			EXECUTE SaveTableAsHTML @DBFetch = ''SELECT DISTINCT pg.UPC, nd.Name DeviceName, STUFF((SELECT ^, ^ + cptg.rateplancarrierbillcode FROM (SELECT * FROM catalogthisweek.RateplanDevice crdt WHERE NOT EXISTS (SELECT * FROM cataloglastweek.rateplandevice crdl WHERE crdt.UPC = crdl.UPC AND crdt.RateplanCarrierBillCode = crdl.RateplanCarrierBillCode)) cptg WHERE cptg.upc = pg.upc FOR XML PATH (^^)), 1, 1, ^^) ^RateplanBillCodes^ FROM (SELECT * FROM catalogthisweek.RateplanDevice crdt WHERE NOT EXISTS (SELECT * FROM cataloglastweek.rateplandevice crdl WHERE crdt.UPC = crdl.UPC AND crdt.RateplanCarrierBillCode = crdl.RateplanCarrierBillCode)) pg LEFT OUTER JOIN catalogthisweek.device nd ON nd.upc = pg.upc''&#xA;		END&#xA;&#xA;/*&#xA;IF EXISTS (SELECT 1 FROM report.old_rateplandevice)&#xA;		BEGIN&#xA;			PRINT ''&lt;h4&gt;06. Removed Associations for Rateplan to Device&lt;/h4&gt;''&#xA;			EXECUTE SaveTableAsHTML @DBFetch = ''SELECT DISTINCT pg.UPC, nd.Name AS DeviceName, STUFF((SELECT ^, ^ + cptg.rateplancarrierbillcode FROM (SELECT * FROM cataloglastweek.RateplanDevice crdl WHERE NOT EXISTS (SELECT * FROM catalogthisweek.rateplandevice crdt WHERE crdl.UPC = crdt.UPC AND crdl.RateplanCarrierBillCode = crdt.RateplanCarrierBillCode)) cptg WHERE cptg.upc = pg.upc FOR XML PATH (^^)), 1, 1, ^^) ^RateplanBillCodes^ FROM (SELECT * FROM cataloglastweek.RateplanDevice crdl WHERE NOT EXISTS (SELECT * FROM catalogthisweek.rateplandevice crdt WHERE crdl.UPC = crdt.UPC AND crdl.RateplanCarrierBillCode = crdt.RateplanCarrierBillCode)) pg INNER JOIN cataloglastweek.device nd ON nd.upc = pg.upc''&#xA;		END&#xA;*/&#xA;&#xA;IF (SELECT MAX(1) FROM report.new_rateplans) &gt; 0 OR (SELECT MAX(1) FROM report.new_services) &gt; 0&#xA;		BEGIN&#xA;			PRINT ''&lt;h4&gt;07. New Associations for Rateplan to Service&lt;/h4&gt;''&#xA;			EXECUTE SaveTableAsHTML @DBFetch = ''SELECT DISTINCT pg.RateplanCarrierBillCode, nd.Title RateplanName, STUFF((SELECT ^, ^ + cptg.ServiceCarrierBillCode FROM (SELECT * FROM catalogthisweek.RateplanService crst WHERE NOT EXISTS (SELECT * FROM cataloglastweek.RateplanService crsl WHERE crst.RateplanCarrierBillCode = crsl.RateplanCarrierBillCode AND crst.ServiceCarrierBillCode = crsl.ServiceCarrierBillCode)) cptg WHERE cptg.RateplanCarrierBillCode = pg.RateplanCarrierBillCode FOR XML PATH (^^)), 1, 1, ^^) ServiceBillCodes FROM (SELECT * FROM catalogthisweek.RateplanService crst WHERE NOT EXISTS (SELECT * FROM cataloglastweek.RateplanService crsl WHERE crst.RateplanCarrierBillCode = crsl.RateplanCarrierBillCode AND crst.ServiceCarrierBillCode = crsl.ServiceCarrierBillCode)) pg INNER JOIN catalogthisweek.rateplan nd ON nd.CarrierBillCode = pg.RateplanCarrierBillCode''&#xA;		END&#xA;&#xA;/*&#xA;IF EXISTS (SELECT 1 FROM report.old_rateplanservice)&#xA;		BEGIN&#xA;			PRINT ''&lt;h4&gt;07. Removed Associations for Rateplan to Service&lt;/h4&gt;''&#xA;			EXECUTE SaveTableAsHTML @DBFetch = ''SELECT DISTINCT pg.RateplanCarrierBillCode, nd.Title RateplanName, STUFF((SELECT ^, ^ + cptg.ServiceCarrierBillCode FROM (SELECT * FROM cataloglastweek.RateplanService crsl WHERE NOT EXISTS (SELECT * FROM catalogthisweek.RateplanService crst WHERE crsl.RateplanCarrierBillCode = crst.RateplanCarrierBillCode AND crsl.ServiceCarrierBillCode = crst.ServiceCarrierBillCode)) cptg WHERE cptg.RateplanCarrierBillCode = pg.RateplanCarrierBillCode FOR XML PATH (^^)), 1, 1, ^^) ServiceBillCodes FROM (SELECT * FROM cataloglastweek.RateplanService crsl WHERE NOT EXISTS (SELECT * FROM catalogthisweek.RateplanService crst WHERE crsl.RateplanCarrierBillCode = crst.RateplanCarrierBillCode AND crsl.ServiceCarrierBillCode = crst.ServiceCarrierBillCode)) pg INNER JOIN catalogthisweek.rateplan nd ON nd.CarrierBillCode = pg.RateplanCarrierBillCode''&#xA;		END&#xA;*/&#xA;&#xA;	PRINT ''&lt;/span&gt;&lt;/html&gt;'''&#xA;	&#xA;            SET @count = @count + 1&#xA;            END" SQLTask:CodePage="1252" SQLTask:ResultType="ResultSetType_None" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask"/></DTS:ObjectData></DTS:Executable>
<DTS:Property DTS:Name="ObjectName">ATT Package</DTS:Property>
<DTS:Property DTS:Name="DTSID">{4472D5A0-4C6D-4C81-AACC-875C0DB888C2}</DTS:Property>
<DTS:Property DTS:Name="Description"></DTS:Property>
<DTS:Property DTS:Name="CreationName">SSIS.Package.2</DTS:Property>
<DTS:Property DTS:Name="DisableEventHandlers">0</DTS:Property>
<DTS:PackageVariable>
<DTS:Property DTS:Name="PackageVariableValue" DTS:DataType="8">&lt;Package xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:ddl2="http://schemas.microsoft.com/analysisservices/2003/engine/2" xmlns:ddl2_2="http://schemas.microsoft.com/analysisservices/2003/engine/2/2" xmlns:ddl100_100="http://schemas.microsoft.com/analysisservices/2008/engine/100/100" xmlns:ddl200="http://schemas.microsoft.com/analysisservices/2010/engine/200" xmlns:ddl200_200="http://schemas.microsoft.com/analysisservices/2010/engine/200/200" xmlns:dwd="http://schemas.microsoft.com/DataWarehouse/Designer/1.0"&gt;&lt;dwd:DtsControlFlowDiagram&gt;&lt;dwd:BoundingTop&gt;-4415&lt;/dwd:BoundingTop&gt;&lt;dwd:Layout&gt;&lt;dds&gt;
  &lt;diagram fontclsid="{0BE35203-8F91-11CE-9DE3-00AA004BB851}" mouseiconclsid="{0BE35204-8F91-11CE-9DE3-00AA004BB851}" defaultlayout="Microsoft.DataWarehouse.Layout.GraphLayout100" defaultlineroute="Microsoft.DataWarehouse.Layout.GraphLayout100" version="7" nextobject="5" scale="100" pagebreakanchorx="0" pagebreakanchory="0" pagebreaksizex="0" pagebreaksizey="0" scrollleft="0" scrolltop="-5415" gridx="150" gridy="150" marginx="1000" marginy="1000" zoom="100" x="26353" y="16007" backcolor="15334399" defaultpersistence="2" PrintPageNumbersMode="3" PrintMarginTop="0" PrintMarginBottom="635" PrintMarginLeft="0" PrintMarginRight="0" marqueeselectionmode="1" mousepointer="0" snaptogrid="0" autotypeannotation="1" showscrollbars="0" viewpagebreaks="0" donotforceconnectorsbehindshapes="1" backpictureclsid="{00000000-0000-0000-0000-000000000000}"&gt;
    &lt;font&gt;
      &lt;ddsxmlobjectstreamwrapper binary="01010000900180380100065461686f6d61" /&gt;
    &lt;/font&gt;
    &lt;mouseicon&gt;
      &lt;ddsxmlobjectstreamwrapper binary="6c74000000000000" /&gt;
    &lt;/mouseicon&gt;
  &lt;/diagram&gt;
  &lt;layoutmanager&gt;
    &lt;ddsxmlobj /&gt;
  &lt;/layoutmanager&gt;
  &lt;ddscontrol controlprogid="DdsShapes.DdsObjectManagedBridge.2" tooltip="Execute SQL Task" left="0" top="-4415" logicalid="2" controlid="1" masterid="0" hint1="0" hint2="0" width="2879" height="1164" noresize="0" nomove="0" nodefaultattachpoints="0" autodrag="1" usedefaultiddshape="1" selectable="1" showselectionhandles="1" allownudging="1" isannotation="0" dontautolayout="0" groupcollapsed="0" tabstop="1" visible="1" snaptogrid="0"&gt;
    &lt;control&gt;
      &lt;ddsxmlobjectstreaminitwrapper binary="000800003f0b00008c040000" /&gt;
    &lt;/control&gt;
    &lt;layoutobject&gt;
      &lt;ddsxmlobj&gt;
        &lt;property name="LogicalObject" value="{F8517981-8F6B-40F2-9EDD-2DC1057F3BBD}" vartype="8" /&gt;
        &lt;property name="ShowConnectorSource" value="0" vartype="2" /&gt;
      &lt;/ddsxmlobj&gt;
    &lt;/layoutobject&gt;
    &lt;shape groupshapeid="0" groupnode="0" /&gt;
  &lt;/ddscontrol&gt;
&lt;/dds&gt;&lt;/dwd:Layout&gt;&lt;dwd:PersistedViewPortTop&gt;-5415&lt;/dwd:PersistedViewPortTop&gt;&lt;/dwd:DtsControlFlowDiagram&gt;&lt;/Package&gt;</DTS:Property>
<DTS:Property DTS:Name="Namespace">dts-designer-1.0</DTS:Property>
<DTS:Property DTS:Name="ObjectName">{4472D5A0-4C6D-4C81-AACC-875C0DB888C2}</DTS:Property>
<DTS:Property DTS:Name="DTSID">{A52E3801-98E2-4221-B8C5-AA5F4488B5CA}</DTS:Property>
<DTS:Property DTS:Name="Description"></DTS:Property>
<DTS:Property DTS:Name="CreationName"></DTS:Property></DTS:PackageVariable>
<DTS:PackageVariable>
<DTS:Property DTS:Name="PackageVariableValue" DTS:DataType="8">&lt;Package xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:ddl2="http://schemas.microsoft.com/analysisservices/2003/engine/2" xmlns:ddl2_2="http://schemas.microsoft.com/analysisservices/2003/engine/2/2" xmlns:ddl100_100="http://schemas.microsoft.com/analysisservices/2008/engine/100/100" xmlns:ddl200="http://schemas.microsoft.com/analysisservices/2010/engine/200" xmlns:ddl200_200="http://schemas.microsoft.com/analysisservices/2010/engine/200/200" xmlns:dwd="http://schemas.microsoft.com/DataWarehouse/Designer/1.0"&gt;&lt;dwd:DtsControlFlowDiagram&gt;&lt;dwd:BoundingTop&gt;-4415&lt;/dwd:BoundingTop&gt;&lt;dwd:Layout&gt;&lt;dds&gt;
  &lt;diagram fontclsid="{0BE35203-8F91-11CE-9DE3-00AA004BB851}" mouseiconclsid="{0BE35204-8F91-11CE-9DE3-00AA004BB851}" defaultlayout="Microsoft.DataWarehouse.Layout.GraphLayout100" defaultlineroute="Microsoft.DataWarehouse.Layout.GraphLayout100" version="7" nextobject="5" scale="100" pagebreakanchorx="0" pagebreakanchory="0" pagebreaksizex="0" pagebreaksizey="0" scrollleft="0" scrolltop="-5415" gridx="150" gridy="150" marginx="1000" marginy="1000" zoom="100" x="26353" y="16007" backcolor="15334399" defaultpersistence="2" PrintPageNumbersMode="3" PrintMarginTop="0" PrintMarginBottom="635" PrintMarginLeft="0" PrintMarginRight="0" marqueeselectionmode="1" mousepointer="0" snaptogrid="0" autotypeannotation="1" showscrollbars="0" viewpagebreaks="0" donotforceconnectorsbehindshapes="1" backpictureclsid="{00000000-0000-0000-0000-000000000000}"&gt;
    &lt;font&gt;
      &lt;ddsxmlobjectstreamwrapper binary="01010000900180380100065461686f6d61" /&gt;
    &lt;/font&gt;
    &lt;mouseicon&gt;
      &lt;ddsxmlobjectstreamwrapper binary="6c74000000000000" /&gt;
    &lt;/mouseicon&gt;
  &lt;/diagram&gt;
  &lt;layoutmanager&gt;
    &lt;ddsxmlobj /&gt;
  &lt;/layoutmanager&gt;
  &lt;ddscontrol controlprogid="DdsShapes.DdsObjectManagedBridge.2" tooltip="Execute SQL Task" left="0" top="-4415" logicalid="2" controlid="1" masterid="0" hint1="0" hint2="0" width="2879" height="1164" noresize="0" nomove="0" nodefaultattachpoints="0" autodrag="1" usedefaultiddshape="1" selectable="1" showselectionhandles="1" allownudging="1" isannotation="0" dontautolayout="0" groupcollapsed="0" tabstop="1" visible="1" snaptogrid="0"&gt;
    &lt;control&gt;
      &lt;ddsxmlobjectstreaminitwrapper binary="000800003f0b00008c040000" /&gt;
    &lt;/control&gt;
    &lt;layoutobject&gt;
      &lt;ddsxmlobj&gt;
        &lt;property name="LogicalObject" value="{F8517981-8F6B-40F2-9EDD-2DC1057F3BBD}" vartype="8" /&gt;
        &lt;property name="ShowConnectorSource" value="0" vartype="2" /&gt;
      &lt;/ddsxmlobj&gt;
    &lt;/layoutobject&gt;
    &lt;shape groupshapeid="0" groupnode="0" /&gt;
  &lt;/ddscontrol&gt;
&lt;/dds&gt;&lt;/dwd:Layout&gt;&lt;dwd:PersistedViewPortTop&gt;-5415&lt;/dwd:PersistedViewPortTop&gt;&lt;/dwd:DtsControlFlowDiagram&gt;&lt;/Package&gt;</DTS:Property>
<DTS:Property DTS:Name="Namespace">dts-designer-1.0</DTS:Property>
<DTS:Property DTS:Name="ObjectName">package-diagram</DTS:Property>
<DTS:Property DTS:Name="DTSID">{0BD5F6E4-A540-4AD4-999F-477187919E39}</DTS:Property>
<DTS:Property DTS:Name="Description"></DTS:Property>
<DTS:Property DTS:Name="CreationName"></DTS:Property></DTS:PackageVariable></DTS:Executable>